---
path: '/juice-vote'
date: '2020-04-16'
title: '공약쥬스 개발기'
tags: ['retrospective', 'juice-vote', 'side-project']
excerpt: ''
---

[공약쥬스](https://www.juice.vote) 서비스를 개발하면서 배우고 느낀 점을 정리해 본다.

## 사이드 프로젝트

공약쥬스는 다들 직업을 가지고 있는 이들이 콘텐츠, 마케팅, 디자인, 기획 등의 역할을 맡아 퇴근 후 혹은 주말에 조금씩 시간을 내서 만든 사이드 프로젝트이다.

지지정당이 없거나 처음 선거권이 주어진 사람들을 위한 서비스를 만들어보자는 뜻을 모아 시작했다.

나는 초기 기획 단계였던 1월에 합류하여 서버개발을 맡았다. 작업 후반부에는 프론트엔드 쪽도 일부 넘겨 받아서 작업을 했다.

나는 원래 사람들이 가진 정치혐오를 없애고 싶다는 생각을 자주 했다. 우리가 만드는 서비스가 그렇게 할 수 있다고 생각했다.

또, 개발자로 사이드 프로젝트를 하면서 지금껏 접해보지 못했거나 제대로 사용하지 못한 기술을 사용해보고 싶었다.

결론적으로 보면, 나는 기술 면에서도 크게 성장했고 서비스도 12만명 이상의 사용자를 모으면서 꽤나 성공을 거두었다.

사람들이 올리는 후기를 보면서 큰 보람을 느꼈다.

## 사용한 기술

서버는 Express.js와 TypeScript를 이용해 개발했고, 데이터베이스는 MySQL을 사용했다.

원래 회사에서도 express 코드는 계속 만지고 있었고, MySQL도 꾸준히 사용하고 있었던지라 어려움은 크게 없었다.

다만 express를 0부터 서비스 레벨까지 만들어본 것은 처음이었던지라 문서를 읽어가면서 하나하나 썼다.

express-rate-limit, cors, morgan, greenlock, express-async-handler 등 서버를 개발하며 필요한 부분이 생길 때 그에 맞는 라이브러리를 설정해가는 재미도 있었다.

TypeScript는 공부해본 적은 있었지만 실제 사용해보는 것은 처음이었다. 타입이 있는 개발을 하니 정말 정말 좋았다. 타입을 먼저 선언하고, 이에 맞춰서 코드를 수정해나갈 수 있으니 헷갈릴 일이 없었다.

클라우드는 AWS EC2와 RDS를 사용했다. 서버비가 많이 나올까봐 굉장히 걱정했고 그걸 생각해서 여러 장치를 고민했는데, 결론적으로는 기우였다. 22만 명이 넘는 사용자가 접속했음에도 아직 프리티어를 넘어서지 않았다.(ㅎㅎ) 그래도 pm2 log가 안보일 정도로 빠르게 쌓이는 것을 구경할 수 있어 성공적이었다고 생각한다.


### 1. DB 설계를 어떻게 해야 확장성이 있을까



### 2. 누군가가 서버를 더럽히면 어떡하지 / 디도스 등 공격이 들어오거나 해킹이 발생하면 어떡하지

우리 서비스는 가입 절차가 없다. (선거 결과를 저장하는데, 개인정보를 저장하는 것이 사용자 입장에서 맞지 않았다. 물론, 번거로운 절차를 거쳐야 한다는 것도 있었다.)

사이트에 접속하면 토큰을 발행했고
공약을 선택한 후에 결과를 제출할 때 해당 토큰이 DB에 존재하는지를 확인했다.

토큰 발급 후 바로 제출할 수 없도록 시간 차도 두었다.

CORS를 설정했다.

PM2 log를 간간히 모니터링 했는데, 이상한 시도는 없었던 것으로 보인다.

Ddos 공격을 막는 방법으로는, 동일한 IP 주소에서 연속하여 요청이 들어오면 막는 라이브러리를 사용했다. 간편하게 설정할 수 있었다.

### 3. 동시접속자가 너무 많아서 느리면 어떡하지

지금 내가 다니는 회사는 엄청나게 많은 데이터를 다루고 있다. 속도가 매우 중요한 회사이다.

그래서 나는 DB를 설계하고 서버를 만드는 내내 

### 4. HTTPS는 어떻게 적용하지

### 5. interface에서 key가 변경되는 경우에는 타입을 어떻게 설정하지


## 좋았던 점

결과가 좋았다.

## 아쉬운 점

지나고 보면 아쉬운 게 더 많이 남는다.

시간이 부족했던 것이 제일 아쉽다.

기획이 어그러졌고, 이를 메꾸느라 시간이 많이 걸렸다.

가장 중요한 부분인 10대 공약이 늦게 발표되는 것도 걸림돌이었다.

각 정당의 10대 공약은 3월 중순이 넘어서야 선관위 홈페이지에 게재된다.

해당 공약을 분류하고, 거기에 맞는 이슈를 고민하고, 문구를 수정하고, 기획 상 수정할 부분은 없을지 고민했다.

원래는 3월 막날에 오픈하는 것이 목표였으나, 4월 첫째주로 미뤄졌다. 사전투표 일정을 고려하면 부족한 부분이 있을지라도 4월 초에는 꼭 오픈을 해야 했다.

개발팀은 물론이고, 콘텐츠, 디자인, 마케팅 모두 회사를 휴가내고 일을 해야 했다.

코드리뷰할 시간도 없이 master에 계속 push를 했다. 재사용하거나 규모를 더 키워나갈 서비스는 아니었으니까 개인적인 아쉬움이다.

시간이 부족한 만큼, lean했으면 더 좋았을 것 같다.

개발팀도 프론트엔드와 백엔드로 각각 역할을 나눴는데, 나보다는 프론트엔드 쪽의 일이 더 밀리고 양도 많았다.

나는 어떻게 코드를 만들면 좋을지 구상하고 설계하는 데에 시간이 많이 소요되었지만, 그래도 백엔드에서의 설계가 바뀔 일은 거의 없었다.

반면, 화면은 기획이 조금 더 자주 변경되는 쪽이었다.